define(["connector","render-v2","scenario","jc","jquery"],function(e,t,n){var r=[];e.socket.on("trigger-push",function(t){setTimeout(function(){setTimeout(function(){for(var e in r)r[e].piece.del();r=[]},t.at-e.currentTime())},t.at-e.currentTime())}),$(function(){function o(){function e(){s.animate({radius:500,opacity:0},1e3,function(){this.animate({radius:.01,opacity:1},1,function(){}),setTimeout(e,500)})}s=jc.circle(.5*t.width(),.5*t.height(),.01,"#DDD",!0),e()}var i=!0;t.onInit(function(){i&&o(),$(window).click(function(e){if(r.length>0)return;if(i)return;var n=e.pageX/2,s=e.pageY/2,o=jc.circle(n,s,10,"#DDD",!0).name("marker"),u={x:n/t.width(),y:s/t.height()};$.get("/click/"+u.x+"/"+u.y,function(e){try{var t=e.result;t!=="OK"?o.del():r.push({piece:o,point:u})}catch(n){o.del()}})})}),t.init(),e.onEstablished(function(){i=!1,s.animate({color:"rgba(231, 231, 231, 0)"},1500),n.run()});var s})})