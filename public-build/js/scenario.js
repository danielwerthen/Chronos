define(["connector","render-v2","clock","boom","two-step","pond","jquery","jc"],function(e,t,n,r,i,s){function a(e){return e*t.width()}function f(e){return e*t.height()}function l(){return 1/(window.innerWidth/t.width())}function c(e,t,n,r,i,s){return jc.circle(e,t,(r||10)*l(),n||"#FFF",!0).id(i).name(s)}function h(e){jc(".marker").animate({color:"rgba(231,231,231,0)"},e/4,function(){this.animate({color:"rgba(231,231,231,1)"},e/4,function(){})})}function p(){t.onLoop(function(e,t){v(e,t),h(t),setTimeout(function(){h(t)},t/2)})}function d(){for(var e in u)u[e].update(e==o)}function v(e,t){o>=0&&o<u.length&&u[o].loop(e,t)}function m(e){o>=0&&o<u.length&&u[o].updateColor(e)}function g(){d()}var o=1,u=[n,i,s,r];return e.socket.on("sanity-check",function(e){var n=Number(e.scene)-1;n!==o&&(console.log("got: "+n+" is: "+o),o=n,d(),console.log("asylym sceneed"));var r=Number(e.color)-1;r!==t.currentColorId()&&(t.setColor(r),m(1),console.log("asylym colored"))}),e.socket.on("trigger-scene",function(t){var n=t.at-e.currentTime();if(o===t.scene-1)return;n<10?(o=t.scene-1,o<0&&(o=0),d()):setTimeout(function(){o=t.scene-1,o<0&&(o=0),d()},n-50)}),e.socket.on("trigger-push",function(n){setTimeout(function(){var e=jc.circle(n.point.x*t.width(),n.point.y*t.height(),.01,"#FFF",!0).animate({radius:300*l(),opacity:0},1600,{type:"inOut",fn:"exp"},function(){this.del()})},n.at-e.currentTime())}),e.socket.on("trigger-color",function(n){var r=n.at-e.currentTime(),i=n.fade*1e3;n.color-1!==t.currentColorId()&&t.setColor(n.color-1),r<10?m(1):r<i?r<1?m(1):m(r):setTimeout(function(){i<1?m(1):m(i)},r-i)}),t.onInit(g),{run:p}})